ALTER SESSION SET STATISTICS_LEVEL='ALL';
SET LINESIZE 150
SET PAGESIZE 1000

VARIABLE N1 NUMBER
VARIABLE N2 NUMBER

ALTER SYSTEM FLUSH BUFFER_CACHE;
ALTER SYSTEM FLUSH BUFFER_CACHE;

EXEC :N1 := 1
EXEC :N2 := 100

SELECT
  T3.C1,
  T4.C2
FROM
  T3,
  T4
WHERE
  T3.C1 BETWEEN :N1 AND :N2
  AND T3.C1=T4.C1;

EXEC :N2 := 10000

SELECT
  T3.C1,
  T4.C2
FROM
  T3,
  T4
WHERE
  T3.C1 BETWEEN :N1 AND :N2
  AND T3.C1=T4.C1;

SPOOL PLAN1.TXT
SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY_CURSOR(NULL,NULL,'TYPICAL'));
SPOOL OFF

ALTER SYSTEM FLUSH BUFFER_CACHE;
ALTER SYSTEM FLUSH BUFFER_CACHE;

SELECT
  T3.C1,
  T4.C2
FROM
  T3,
  T4
WHERE
  T3.C1 BETWEEN :N1 AND :N2
  AND T3.C1=T4.C1;

SPOOL PLAN2.TXT
SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY_CURSOR(NULL,NULL,'ALLSTATS LAST'));
SPOOL OFF

ALTER SYSTEM FLUSH BUFFER_CACHE;
ALTER SYSTEM FLUSH BUFFER_CACHE;

EXEC :N2 := 100

SELECT /*+ USE_NL(T3 T4) */
  T3.C1,
  T4.C2
FROM
  T3,
  T4
WHERE
  T3.C1 BETWEEN :N1 AND :N2
  AND T3.C1=T4.C1;

EXEC :N2 := 10000

SELECT /*+ USE_NL(T3 T4) */
  T3.C1,
  T4.C2
FROM
  T3,
  T4
WHERE
  T3.C1 BETWEEN :N1 AND :N2
  AND T3.C1=T4.C1;

SPOOL PLAN3.TXT
SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY_CURSOR(NULL,NULL,'ALLSTATS LAST'));
SPOOL OFF

